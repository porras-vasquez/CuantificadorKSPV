<!DOCTYPE html>
<html>
<header>
    <!--ZONA DEL NAVBAR-->
    <%- include('../navbar'); -%>
</header>
<script>
    function removeMessage() {
        localStorage.removeItem("message");
    }
</script>

<body style="background-color: #c5dfbe;">
    <div class="container mt-5">
        <div class="row clearfix">
            <div class="col-lg-12">
                <div class="card" style="background-color: #e6e6e6;">
                    <% if(typeof(status) !="undefined" ) { %>
                        <% if(status==200) { %>
                            <script>
                                if (!localStorage.getItem("message")) {
                                    Swal.fire({
                                        position: 'center',
                                        icon: 'success',
                                        title: '<%-message%>',
                                        showConfirmButton: false,
                                        timer: 2500
                                    });
                                    localStorage.setItem("message", 1);
                                }  
                            </script>
                            <% }else if(status !=200){ %>
                                <script>
                                    if (!localStorage.getItem("message")) {
                                        Swal.fire({
                                            position: 'center',
                                            icon: 'error',
                                            title: '<%-message%>',
                                            showConfirmButton: false,
                                            timer: 2500
                                        });
                                        localStorage.setItem("message", 1);
                                    }  
                                </script>
                                <% } %>
                                    <% } %>
                                        <div class="chat">
                                            <div id="menu-container" class="menu-container">
                                                <div id="menu" class="menu">
                                                    <i id="expand" class="material-icons" style="font-size: 35px">menu_open</i>
                                                </div>
                                                <div class="flex-menu">
                                                    <ul class="list-unstyled chat-list">
                                                        <ul class="list-group list-group-flush button flex-color">
                                                            <a onclick="window.location. href='/users/show'"
                                                                type="button" class="btn btn primary ">Mostrar usuarios</a>
                                                        </ul>
                                                        <ul class="list-group list-group-flush button flex-color">
                                                            <a href="/users/show" type="button"
                                                                class="btn btn primary ">Atrás</a>
                                                        </ul>
                                                    </ul>
                                                </div>
                                            </div>
                                            <div style="background-color: #e6e6e6; margin-top: 4%; margin-bottom: 4%;">
                                                <div class="container">
                                                    <p></p>
                                                    <h1 class="title">Información Personal</h1>
                                                    <form action="/users/save" method="post" class="newUser">
                                                        <div class="col-6">

                                                            <div class="mb-2">
                                                                <label for="exampleInputEmail1"
                                                                    class="form-label">Nombre de usuario</label>
                                                                <input onchange="enable()" id="username" type="text"
                                                                    name="username" class="form-control"
                                                                    pattern="^[a-zA-Z]{2,8}[\d]{2,8}$" minlength="4"
                                                                    maxlength="16"
                                                                    placeholder="Ingrese el nombre de usuario"
                                                                    required />
                                                            </div>
                                                            <div class="mb-2">
                                                                <label for="inputPassword"
                                                                    class="form-label">Contraseña</label>
                                                                <input onchange="enable()" id="password" type="password"
                                                                    name="password" class="form-control"
                                                                    pattern="^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{8,16}$"
                                                                    minlength="8" maxlength="16"
                                                                    placeholder="Ingrese una contraseña valida"
                                                                    required />
                                                            </div>
                                                            <div class="mb-2">
                                                                <label for="exampleInputEmail1"
                                                                    class="form-label">Email</label>
                                                                <input onchange="enable()" id="email" type="text"
                                                                    name="email" class="form-control"
                                                                    pattern="^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$"
                                                                    placeholder="Ingrese un correo valido" required />
                                                            </div>
                                                            <div class="btnContainer mb-4" style="padding-bottom: 3%;">

                                                                <button onclick="removeMessage()" disabled id="submit"
                                                                    type="submit" name="UserController"
                                                                    class="btn btn-success">
                                                                    Guardar
                                                                </button>
                                                                <button type="button" class="btn btn-danger">
                                                                    <a href="/users/show" type="button">Cancelar</a>
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        /*$('#username').change(function(){
            document.getElementById('submit').disabled=false;
        });*/
        let username = document.querySelector("#username");
        let password = document.querySelector("#password");
        let email = document.querySelector("#email");

        function enable() {
            if (document.getElementById('username').value == "" && document.getElementById('password').value == "" &&
                document.getElementById('email').value == "") {
                document.getElementById('submit').disabled = true;
            } else {
                document.getElementById('submit').disabled = false;
            }
        }
    </script>
</body>
<footer class="bg-light text-center text-lg-start footer" style="margin-top: 7%;">
    <!-- Copyright -->
    <div class="text-center p-4">
        © 2022 Copyright: Porras & Vásquez
    </div>
    <!-- Copyright -->
</footer>

</html>